""" Created on Thu Jun 21 14:31:46 2018
Author: Nicholas Irvin 

The function particle_flux is used to find the generation current 
and the radiative recombination currents for light between energies E1 and E2. 
The Jsc functions calculate the short-circuit current as the difference 
between these two currents. For non-zero voltages, the loss in current is 
calculated from the particle_flux with the voltage set as the chemical potential. 
Finally the function max-power-pt uses this relation to maximize the power. """

# Import libraries
import numpy as np
from numba import jit
from scipy.integrate import trapz
from scipy.optimize import  minimize_scalar, brentq


# Set constants
c = 2.99792458e8               
# m/s  The speed of light
h = 6.6260755e-34              
# J*s  Planck's constant
k = 1.380658e-23               
# J/K  Boltzmann's constant
q = 1.60217733e-19             
# C    The charge of an electron
g = 2*np.pi/(c**2)/(h**3)      
# s^5/(kg^3*m^8)  The coefficient for particle flux
f = 1/46200                    
# sr  (The solid angle of the sun from Earth)/Pi
infinity = 10                  
# J  10 is considered to be a very large bandgap
T_sun = 5778                   
# K  Effective temperature of the sun








@jit    # Increases computation speed
def particle_flux(E1, E2, T, mu):
    """
    Purpose: Calculate number of photons (1/s*m^2)
    squared) exiting material of temperature T (K) and 
    chemical potential mu in between energies E1 and E2 (in eV) .
    
    Used by the current_voltage, find_Jsc, and max_power_pt functions.
    """   
    # Sample usage: within the current_voltage document, E1 = Eg, 
    # E2 = infinity = 10, T = 300 C, and mu = cell voltage.  
    
    # Setup a midpoint integral.
    n = 5*10**3 # Number of subintervals usually 5*10**3
    w = (E2*q-E1*q)/n # Interval width
    # Multiply by q to convert from eV to J.
    E = np.linspace(E1*q + w/2, E2*q - w/2, n)
    # Vectorize the energy space.
    return w*np.sum(  g*E**2  /  (np.exp( (E-(q*mu)) / (k*T) ) - 1))
    # Integrate (specral photon flux) = (photonic density of states)*(Bose-Einstein distribution function) 
    # from E1 to E2 to get the total photon flux.
    # This handmade integral allows for the use of @jit, which increases speed.

    


    
    
def spectrum_particle_flux(E1, E2, spectrum):	
    """ Purpose: Calculates the particle flux for non-blackbody spectra. 
    
    The output is technically photocurrent, which is (photon flux)*(charge of the electron).
    Used by the find_Jsc function. """
    
    # Spectral photon flux (1/s*m^2*nm) from 2008 global standards (ASTM173‚Äê03):
    if spectrum == 1:  # 1.5AMG spectrum
        J_wavelength = [6.6684e-05,0.0017378,0.0080483,0.22195,1.6959,6.4616,26.288,50.465,1039,3559.9,11498,61245,197020,1209000,3954000,15780000,90378000,249250000,818580000,3023900000.00000,8783900000.00000,20156000000.0000,51349000000.0000,160140000000.000,394390000000.000,628530000000.000,1275400000000.00,3355000000000.00,6178200000000.00,9771600000000.00,18251000000000.0,41393000000000.0,71382000000000.0,10649,14473,27868,43487,53780,74072,1.2977e+15,1.5412e+15,1.8834e+15,2.9245e+15,4.0850e+15,4.4407e+15,6.5238e+15,1.0821e+16,1.3719e+16,1.4493e+16,1.8323e+16,2.5277e+16,2.8788e+16,2.8617e+16,3.2569e+16,4.3040e+16,5.5163e+16,5.8667e+16,6.4342e+16,6.3052e+16,6.7473e+16,7.9494e+16,1.0245e+17,1.2982e+17,1.3185e+17,1.4666e+17,1.5572e+17,1.6912e+17,1.6977e+17,1.8920e+17,2.0677e+17,2.1606e+17,1.8802e+17,1.9643e+17,2.3957e+17,2.7381e+17,2.9162e+17,2.8165e+17,2.9808e+17,3.2872e+17,3.1507e+17,3.3067e+17,3.9569e+17,4.0438e+17,3.8589e+17,3.5991e+17,3.5245e+17,3.4514e+17,4.0487e+17,4.4914e+17,4.6264e+17,4.5637e+17,5.3150e+17,6.2560e+17,6.6932e+17,6.5527e+17,6.3416e+17,5.7983e+17,6.1458e+17,6.9951e+17,7.7758e+17,7.8310e+17,7.1210e+17,6.7088e+17,6.9766e+17,7.2908e+17,7.3513e+17,7.1990e+17,6.8371e+17,6.9773e+17,7.4949e+17,7.8230e+17,7.6531e+17,7.0228e+17,6.4734e+17,6.3415e+17,6.8047e+17,7.3865e+17,7.7580e+17,7.9108e+17,8.1089e+17,8.5888e+17,8.5827e+17,8.0920e+17,8.0688e+17,8.4248e+17,8.7532e+17,8.8906e+17,8.4056e+17,7.2461e+17,6.9902e+17,7.9714e+17,8.5107e+17,8.3220e+17,8.4873e+17,8.6301e+17,8.3399e+17,8.3233e+17,8.4800e+17,8.1809e+17,8.4109e+17,9.3027e+17,1.0012e+18,9.7487e+17,9.3822e+17,9.1774e+17,8.6884e+17,9.2477e+17,1.0184e+18,1.0781e+18,1.0914e+18,1.0926e+18,1.0564e+18,9.9261e+17,9.3218e+17,8.2083e+17,8.3173e+17,7.7506e+17,7.2056e+17,8.4856e+17,1.0234e+18,1.0841e+18,1.0259e+18,9.4544e+17,9.2731e+17,9.7350e+17,1.0677e+18,1.0999e+18,1.0712e+18,1.1110e+18,1.1020e+18,1.1458e+18,1.2627e+18,1.3548e+18,1.3590e+18,1.3355e+18,1.3119e+18,1.2367e+18,1.2301e+18,1.2876e+18,1.3852e+18,1.4064e+18,1.2732e+18,1.2950e+18,1.3475e+18,1.2630e+18,1.2049e+18,1.1620e+18,1.0489e+18,1.0476e+18,1.0412e+18,1.1125e+18,1.2318e+18,1.2773e+18,1.2583e+18,1.3518e+18,1.5099e+18,1.6288e+18,1.5895e+18,1.4193e+18,1.2739e+18,1.3405e+18,1.4380e+18,1.4650e+18,1.3220e+18,1.1284e+18,9.7745e+17,8.7725e+17,8.5040e+17,9.8526e+17,1.1877e+18,1.3054e+18,1.2491e+18,1.2067e+18,1.2563e+18,1.2692e+18,1.2524e+18,1.2419e+18,1.2348e+18,1.3423e+18,1.4896e+18,1.5647e+18,1.5799e+18,1.6758e+18,1.7017e+18,1.5687e+18,1.3092e+18,9.4914e+17,7.5576e+17,9.8313e+17,1.3581e+18,1.6061e+18,1.7130e+18,1.5082e+18,1.0982e+18,8.5176e+17,1.2596e+18,1.7080e+18,2.0199e+18,2.1478e+18,2.2165e+18,2.2434e+18,2.3423e+18,2.4408e+18,2.3560e+18,2.4001e+18,2.3469e+18,2.2946e+18,2.2591e+18,2.3649e+18,2.5323e+18,2.1641e+18,2.4286e+18,2.5880e+18,2.4889e+18,2.4680e+18,2.5609e+18,2.6437e+18,2.5846e+18,2.4782e+18,2.5856e+18,2.3748e+18,2.7037e+18,2.6731e+18,2.5945e+18,2.5863e+18,2.6718e+18,2.6024e+18,2.5202e+18,2.5508e+18,2.3676e+18,1.8933e+18,1.7226e+18,2.8722e+18,2.6785e+18,2.4802e+18,2.7268e+18,2.9980e+18,3.0673e+18,2.6984e+18,2.6022e+18,2.9900e+18,2.9555e+18,3.1707e+18,3.2232e+18,3.1480e+18,3.2749e+18,2.9430e+18,3.3535e+18,3.4012e+18,3.4006e+18,3.5328e+18,3.6719e+18,3.5228e+18,3.2604e+18,3.5048e+18,3.4871e+18,3.6095e+18,3.6474e+18,3.5769e+18,3.5563e+18,3.5409e+18,3.6730e+18,3.7154e+18,3.7365e+18,3.6308e+18,3.5932e+18,3.6767e+18,3.5200e+18,3.6798e+18,3.7025e+18,3.5673e+18,3.6351e+18,3.8317e+18,3.6905e+18,3.7394e+18,3.8702e+18,3.7456e+18,3.7758e+18,3.9054e+18,3.8379e+18,3.9099e+18,3.9171e+18,3.9396e+18,3.8996e+18,3.8336e+18,3.8291e+18,3.1111e+18,3.4913e+18,3.7864e+18,3.5741e+18,4.0020e+18,3.8547e+18,3.6827e+18,3.9468e+18,3.8608e+18,4.1079e+18,3.9142e+18,3.9891e+18,3.8881e+18,3.8954e+18,3.8891e+18,3.7776e+18,3.7821e+18,3.9636e+18,3.7010e+18,3.9748e+18,4.1429e+18,3.9714e+18,3.8782e+18,4.0724e+18,3.9746e+18,4.0565e+18,4.1719e+18,3.9269e+18,3.8515e+18,3.9703e+18,4.0146e+18,3.2778e+18,3.7558e+18,3.6466e+18,3.9884e+18,4.0249e+18,4.1230e+18,3.8937e+18,4.1955e+18,4.1708e+18,4.0622e+18,3.5595e+18,4.0819e+18,4.2798e+18,4.1211e+18,4.3550e+18,4.2845e+18,3.8332e+18,4.1135e+18,4.1840e+18,4.3710e+18,4.0520e+18,4.2624e+18,4.1656e+18,4.0301e+18,3.8812e+18,4.2322e+18,4.1703e+18,4.3247e+18,4.2347e+18,4.2029e+18,4.2654e+18,4.1516e+18,4.2893e+18,4.2636e+18,4.2667e+18,4.3619e+18,4.2454e+18,4.3365e+18,4.3680e+18,4.3009e+18,4.2026e+18,4.3006e+18,4.0756e+18,4.1554e+18,4.4042e+18,4.2005e+18,4.3669e+18,4.2890e+18,4.3236e+18,4.0956e+18,4.3729e+18,4.3405e+18,4.2413e+18,4.2514e+18,4.1194e+18,4.3579e+18,4.3839e+18,4.3688e+18,4.2774e+18,4.2491e+18,4.3637e+18,4.2365e+18,4.3051e+18,4.3855e+18,4.4133e+18,4.4885e+18,4.5429e+18,4.5416e+18,4.5129e+18,4.4111e+18,4.5156e+18,4.4206e+18,3.8232e+18,4.0717e+18,4.3622e+18,4.2778e+18,4.3468e+18,4.3332e+18,4.2857e+18,4.4240e+18,4.4443e+18,4.3973e+18,4.4043e+18,4.4561e+18,4.4109e+18,4.3518e+18,4.4514e+18,4.5369e+18,4.5365e+18,4.5217e+18,4.5564e+18,4.5489e+18,4.5217e+18,4.5098e+18,4.4941e+18,4.5692e+18,4.5119e+18,4.3817e+18,4.5502e+18,4.4376e+18,4.3882e+18,4.5621e+18,4.5910e+18,4.6003e+18,4.6274e+18,4.4679e+18,4.4425e+18,4.4349e+18,4.4130e+18,4.4157e+18,4.5506e+18,4.3093e+18,4.4691e+18,4.4160e+18,4.4983e+18,4.3390e+18,4.6231e+18,4.5589e+18,4.6217e+18,4.5234e+18,4.6850e+18,4.7235e+18,4.7113e+18,4.6201e+18,4.6299e+18,4.6462e+18,4.7016e+18,4.6885e+18,4.7299e+18,4.6016e+18,4.5879e+18,4.5513e+18,4.4168e+18,4.4482e+18,4.7346e+18,4.5528e+18,4.7044e+18,4.6596e+18,4.4511e+18,3.9136e+18,4.0989e+18,4.5894e+18,4.6130e+18,4.6489e+18,4.6363e+18,4.6053e+18,4.6206e+18,4.6687e+18,4.7584e+18,4.7619e+18,4.7351e+18,4.7583e+18,4.8476e+18,4.7881e+18,4.7861e+18,4.7266e+18,4.7750e+18,4.7753e+18,4.7430e+18,4.8051e+18,4.7683e+18,4.8009e+18,4.7673e+18,4.7819e+18,4.7704e+18,4.8000e+18,4.7552e+18,4.7308e+18,4.7408e+18,4.6407e+18,3.3486e+18,3.8812e+18,3.9118e+18,4.1061e+18,4.2901e+18,4.4203e+18,4.3988e+18,4.3545e+18,4.4483e+18,4.4441e+18,4.7028e+18,4.6354e+18,4.5456e+18,4.5187e+18,4.4673e+18,4.4789e+18,4.5111e+18,4.6349e+18,4.6897e+18,4.6715e+18,4.6589e+18,4.6505e+18,4.6738e+18,4.7090e+18,4.7085e+18,4.6850e+18,4.6367e+18,4.6831e+18,4.5306e+18,4.5834e+18,3.9960e+18,3.7215e+18,3.3415e+18,3.5720e+18,3.9421e+18,4.5095e+18,4.1652e+18,3.8470e+18,3.7884e+18,3.9519e+18,3.9709e+18,3.8114e+18,3.8409e+18,4.1471e+18,3.9386e+18,4.2502e+18,4.4140e+18,4.5660e+18,4.5059e+18,4.4680e+18,4.4666e+18,4.5581e+18,4.4289e+18,4.5429e+18,4.5315e+18,4.5395e+18,4.6399e+18,4.6828e+18,4.6869e+18,4.6830e+18,4.6920e+18,4.6696e+18,4.6593e+18,4.6594e+18,4.6449e+18,4.6677e+18,4.6497e+18,4.7143e+18,4.7065e+18,4.6552e+18,4.6572e+18,4.6916e+18,4.5641e+18,1.0178e+18,5.8981e+17,2.6379e+18,1.4577e+18,2.0722e+18,2.6419e+18,3.1412e+18,3.7614e+18,4.3062e+18,4.3660e+18,4.4996e+18,4.5357e+18,4.5773e+18,4.5805e+18,4.5865e+18,4.5924e+18,4.6089e+18,4.5870e+18,4.5874e+18,4.6137e+18,4.5690e+18,4.5635e+18,4.5910e+18,4.5779e+18,4.5530e+18,4.5785e+18,4.5867e+18,4.5363e+18,4.4846e+18,4.4712e+18,4.3389e+18,4.4033e+18,4.3670e+18,4.3414e+18,4.3856e+18,4.3751e+18,4.3045e+18,4.3785e+18,4.4676e+18,4.3863e+18,4.3193e+18,4.3722e+18,4.3830e+18,4.3080e+18,4.3639e+18,4.2733e+18,4.4527e+18,4.4115e+18,4.4015e+18,4.2958e+18,4.3056e+18,4.3003e+18,4.1972e+18,4.1279e+18,3.7026e+18,3.6730e+18,3.4184e+18,3.5035e+18,3.3873e+18,3.7320e+18,3.5578e+18,4.1233e+18,3.9376e+18,2.7871e+18,3.8787e+18,4.0258e+18,3.8829e+18,4.0993e+18,3.5421e+18,3.8782e+18,3.8274e+18,3.8651e+18,3.7455e+18,4.0110e+18,3.9219e+18,4.2169e+18,4.0921e+18,4.2523e+18,4.2144e+18,4.2291e+18,4.2950e+18,4.2764e+18,4.2261e+18,4.2662e+18,4.1906e+18,4.3240e+18,4.3385e+18,4.2285e+18,4.2355e+18,4.2140e+18,3.8242e+18,4.1766e+18,4.1573e+18,4.1432e+18,3.6591e+18,3.9297e+18,4.1936e+18,4.2783e+18,4.2845e+18,4.2885e+18,4.2781e+18,4.2771e+18,4.3155e+18,4.3466e+18,4.2588e+18,4.1944e+18,3.7013e+18,3.9956e+18,4.1913e+18,4.1540e+18,4.2376e+18,4.1824e+18,4.2443e+18,4.2067e+18,4.1377e+18,4.0827e+18,4.2016e+18,4.2213e+18,4.2094e+18,4.1443e+18,4.1623e+18,4.0297e+18,4.1402e+18,4.1307e+18,4.1522e+18,4.2067e+18,4.0477e+18,4.0662e+18,4.1229e+18,4.1824e+18,4.1395e+18,4.1528e+18,4.0809e+18,3.9258e+18,3.8313e+18,3.6656e+18,3.4394e+18,3.0059e+18,3.2449e+18,2.4833e+18,3.3645e+18,2.7184e+18,3.0328e+18,3.1316e+18,3.8435e+18,3.7226e+18,3.5373e+18,2.9155e+18,2.9811e+18,3.2229e+18,2.8616e+18,3.0639e+18,3.1630e+18,2.8879e+18,2.8826e+18,3.1247e+18,2.6582e+18,3.3707e+18,2.7391e+18,3.4178e+18,3.4464e+18,3.6187e+18,3.2502e+18,3.4618e+18,3.3561e+18,3.3113e+18,3.2785e+18,3.6746e+18,2.7548e+18,2.5781e+18,2.0230e+18,1.9179e+18,1.4116e+18,1.1667e+18,6.7613e+17,1.1807e+18,7.6060e+17,7.7066e+17,9.4714e+17,1.8855e+18,2.2326e+18,1.7620e+18,1.9221e+18,1.3213e+18,1.3581e+18,1.7517e+18,9.2679e+17,1.7692e+18,1.3087e+18,2.3598e+18,7.0426e+17,2.3161e+18,1.2887e+18,1.6485e+18,2.0368e+18,1.6402e+18,1.5795e+18,1.3040e+18,2.2233e+18,1.8048e+18,2.0329e+18,2.2312e+18,2.1393e+18,2.4483e+18,2.2255e+18,2.4471e+18,2.4448e+18,2.4457e+18,3.1777e+18,3.3474e+18,3.0989e+18,3.4900e+18,3.3648e+18,2.9707e+18,2.8208e+18,2.8952e+18,2.8100e+18,3.1410e+18,3.0283e+18,3.1451e+18,2.9831e+18,3.5230e+18,3.4218e+18,3.3088e+18,3.6524e+18,3.4124e+18,3.7268e+18,3.6732e+18,3.6538e+18,3.7294e+18,3.6495e+18,3.7595e+18,3.7505e+18,3.6856e+18,3.7734e+18,3.7655e+18,3.7547e+18,3.7126e+18,3.7121e+18,3.7143e+18,3.7017e+18,3.7512e+18,3.6724e+18,3.7082e+18,3.6560e+18,3.4491e+18,3.6084e+18,3.6881e+18,3.6883e+18,3.6558e+18,3.6564e+18,3.6786e+18,3.6618e+18,3.6595e+18,3.6788e+18,3.6185e+18,3.6380e+18,3.6010e+18,3.6602e+18,3.5333e+18,3.5890e+18,3.6069e+18,3.5484e+18,3.5796e+18,3.5599e+18,3.5992e+18,3.5967e+18,3.5831e+18,3.5907e+18,3.5550e+18,3.5806e+18,3.5675e+18,3.5736e+18,3.5160e+18,3.5404e+18,3.5552e+18,3.5570e+18,3.5236e+18,3.5100e+18,3.5377e+18,3.5167e+18,3.5204e+18,3.5250e+18,3.4929e+18,3.5125e+18,3.4958e+18,3.4076e+18,3.4625e+18,3.4965e+18,3.4798e+18,3.4603e+18,3.4666e+18,3.4486e+18,3.4413e+18,3.4301e+18,3.4440e+18,3.4363e+18,3.4311e+18,3.3990e+18,3.2986e+18,3.3930e+18,3.3180e+18,3.3823e+18,3.3306e+18,3.3850e+18,3.3730e+18,3.3117e+18,3.3320e+18,3.3304e+18,3.1549e+18,3.2572e+18,3.3245e+18,3.3208e+18,3.2606e+18,3.3607e+18,3.2065e+18,3.3297e+18,3.2766e+18,3.2735e+18,3.2848e+18,3.2470e+18,3.1608e+18,3.2104e+18,3.2610e+18,3.1570e+18,3.2406e+18,3.0293e+18,3.1025e+18,3.2489e+18,3.1752e+18,3.0494e+18,3.2313e+18,3.1952e+18,2.8094e+18,2.9720e+18,2.8701e+18,2.7765e+18,3.1948e+18,2.7798e+18,2.8090e+18,2.6900e+18,2.7544e+18,2.6009e+18,2.5896e+18,2.5990e+18,2.8172e+18,2.2155e+18,2.6919e+18,2.3184e+18,2.3045e+18,2.6765e+18,1.8543e+18,2.3151e+18,1.5044e+18,1.6816e+18,1.4025e+18,1.1313e+18,4.4770e+17,1.2243e+18,6.3751e+17,8.0001e+17,1.0489e+18,4.6138e+17,7.2458e+17,6.1506e+17,8.1711e+17,2.9243e+17,8.9215e+17,5.6344e+17,6.0194e+17,4.0146e+17,1.6830e+18,1.3341e+18,8.7443e+17,2.3828e+17,8.8346e+16,7.3635e+17,1.6476e+18,1.1646e+18,1.7116e+18,1.4691e+18,1.1107e+18,1.2923e+18,1.7943e+18,6.5227e+17,8.4178e+17,9.0944e+17,3.4169e+17,1.5669e+18,1.2641e+18,7.0420e+17,1.1786e+18,1.4360e+18,1.3821e+18,8.2772e+17,1.8208e+18,1.6347e+18,1.8323e+18,1.8171e+18,1.9658e+18,1.6729e+18,2.0312e+18,2.0475e+18,2.7433e+18,2.3549e+18,2.2790e+18,2.2008e+18,2.4084e+18,2.4668e+18,2.4899e+18,2.7019e+18,2.6428e+18,2.6835e+18,2.6952e+18,1.9912e+18,2.6760e+18,2.8227e+18,2.7987e+18,2.1349e+18,2.8709e+18,2.6178e+18,2.7059e+18,1.9230e+18,2.6126e+18,2.5025e+18,2.4304e+18,2.8488e+18,2.7233e+18,2.0037e+18,2.4881e+18,2.7700e+18,2.6776e+18,2.8405e+18,2.7286e+18,2.8184e+18,2.6888e+18,2.5968e+18,2.8752e+18,2.6169e+18,2.2024e+18,2.7078e+18,2.6426e+18,2.6453e+18,2.6289e+18,2.1970e+18,2.6504e+18,2.9194e+18,2.6119e+18,2.6360e+18,2.5214e+18,2.7615e+18,2.5746e+18,2.5924e+18,2.8673e+18,2.6528e+18,2.6166e+18,2.8551e+18,2.7893e+18,2.8165e+18,2.7408e+18,2.8132e+18,2.8601e+18,2.7768e+18,2.7340e+18,2.7610e+18,2.8513e+18,2.8896e+18,2.6748e+18,2.8843e+18,2.8906e+18,2.8485e+18,2.9252e+18,2.8922e+18,2.8178e+18,2.9207e+18,2.8912e+18,2.9187e+18,2.8856e+18,2.9165e+18,2.8861e+18,2.8763e+18,2.8861e+18,2.8915e+18,2.8630e+18,2.8512e+18,2.8614e+18,2.8819e+18,2.8717e+18,2.8812e+18,2.8902e+18,2.8761e+18,2.8502e+18,2.8423e+18,2.8242e+18,2.8005e+18,2.8474e+18,2.7835e+18,2.7547e+18,2.8179e+18,2.7079e+18,2.7345e+18,2.6120e+18,2.5137e+18,2.5444e+18,2.3638e+18,2.5199e+18,2.4554e+18,2.4762e+18,2.3651e+18,1.5748e+18,2.4770e+18,2.6121e+18,2.6176e+18,2.6034e+18,2.6048e+18,2.6465e+18,2.6782e+18,2.7001e+18,2.7512e+18,2.7336e+18,2.7195e+18,2.6656e+18,2.4076e+18,2.6308e+18,2.7198e+18,2.7427e+18,2.7652e+18,2.7349e+18,2.7225e+18,2.6563e+18,2.6811e+18,2.7157e+18,2.5768e+18,2.6855e+18,2.6331e+18,2.6412e+18,2.5416e+18,2.4243e+18,2.5603e+18,2.6714e+18,2.3109e+18,2.3727e+18,2.5681e+18,2.2709e+18,1.9734e+18,2.5215e+18,2.5281e+18,2.0130e+18,2.2846e+18,2.5313e+18,1.9859e+18,2.2021e+18,2.2018e+18,2.0723e+18,1.9073e+18,1.8920e+18,2.1477e+18,2.0697e+18,2.2113e+18,1.7832e+18,1.7192e+18,1.9861e+18,2.0110e+18,1.5504e+18,1.7495e+18,2.1494e+18,1.8725e+18,1.7786e+18,1.5677e+18,1.1881e+18,1.5348e+18,9.7022e+17,9.7759e+17,1.3625e+18,1.1366e+18,1.5536e+18,1.2340e+18,1.1075e+18,1.1992e+18,1.1918e+18,1.1354e+18,1.1503e+18,1.2024e+18,8.5937e+17,5.1180e+17,7.3830e+17,3.9426e+17,4.0766e+17,3.2200e+16,1.0974e+17,1.0891e+17,3.1488e+16,1.0321e+16,65452,1.9773e+15,2458.0,32814,49039,28677000000000.0,5024200000000.00,14654000000000.0,32978000000.0000,123940000,21657000000000.0,9330900000000.00,62369000,87959000000000.0,34246000000000.0,1019900,3560700000000.00,2013800000000.00,136180000000.000,18992000000000.0,30689,1.2393e+15,2.2380e+15,1.7835e+15,85055,7.6924e+15,36212,56679,16488000000000.0,1786.0,306450000000.000,4298000000000.00,14571000000000.0,17593000000000.0,1.3892e+15,28132000000000.0,4.0624e+15,3.4517e+15,2.4077e+15,16665,81247,53001,4714700000000.00,44425000000.0000,34500,8.9407e+15,5.7205e+15,22881000000.0000,74252000000.0000,1.2953e+16,1.6810e+16,5.2226e+15,2577700000000.00,1.4473e+16,1.2365e+15,1.1690e+16,4.3920e+15,3.3115e+15,1.5017e+16,1.8763e+16,1.6611e+17,2.5895e+15,1.3083e+15,2.5352e+17,8.3881e+16,9.6789e+16,1.5317e+16,5.9130e+16,6.5552e+16,3.3154e+17,6.6046e+16,1.2169e+17,1.8544e+17,1.9951e+17,3.5592e+17,3.2772e+16,2.7351e+17,4.4345e+17,3.6131e+17,1.8162e+16,2.5850e+17,1.5132e+17,1.5471e+17,2.7724e+17,2.1615e+17,9.6012e+16,3.6973e+17,2.8707e+17,2.3068e+17,2.6363e+17,3.2735e+17,4.4917e+17,3.6190e+17,1.6812e+17,2.6380e+17,8.4331e+17,7.4498e+17,2.0009e+17,8.2329e+16,4.5583e+17,5.9963e+17,1.0071e+18,4.8452e+17,6.4874e+17,8.5816e+17,1.0014e+18,1.1977e+18,6.2783e+17,6.6397e+17,9.6120e+17,3.1835e+17,1.1191e+18,6.8870e+17,4.8115e+17,2.6626e+17,5.6861e+17,7.0139e+17,3.6762e+17,1.3217e+17,3.4658e+17,5.2054e+17,7.2228e+17,1.3709e+18,5.1104e+17,5.1851e+17,4.7232e+17,8.9353e+17,4.5178e+17,8.5955e+17,4.3637e+17,1.1093e+18,1.0270e+18,9.3468e+17,9.2312e+17,4.5385e+17,7.0548e+17,1.4222e+18,1.3110e+18,1.4845e+18,1.2349e+18,1.3647e+18,1.5318e+18,1.3737e+18,1.2691e+18,1.7220e+18,1.4304e+18,1.6420e+18,1.8924e+18,2.0063e+18,1.7660e+18,1.3992e+18,1.2136e+18,1.3942e+18,1.9539e+18,1.9356e+18,1.8449e+18,1.4198e+18,2.0564e+18,2.0138e+18,1.9842e+18,1.8462e+18,1.7203e+18,2.0266e+18,1.9601e+18,1.9038e+18,1.9266e+18,1.8687e+18,2.0239e+18,2.1060e+18,2.0211e+18,2.1471e+18,2.1128e+18,1.9871e+18,2.0546e+18,2.0156e+18,2.1483e+18,2.0970e+18,1.9658e+18,2.0789e+18,2.1470e+18,2.1388e+18,2.0767e+18,2.0621e+18,2.1236e+18,2.1151e+18,2.1061e+18,2.1147e+18,2.0537e+18,2.0871e+18,2.0902e+18,2.1134e+18,2.1149e+18,2.1548e+18,2.1388e+18,2.1268e+18,2.0787e+18,2.1321e+18,2.1060e+18,2.1127e+18,2.1237e+18,2.1212e+18,2.0711e+18,2.0947e+18,2.0609e+18,2.1212e+18,2.1057e+18,2.1039e+18,2.0864e+18,2.1219e+18,2.1039e+18,2.0982e+18,2.0679e+18,2.1057e+18,2.0690e+18,2.0753e+18,2.0304e+18,2.0103e+18,1.9107e+18,1.8591e+18,1.8815e+18,1.8535e+18,1.9132e+18,1.9008e+18,1.9579e+18,1.7149e+18,1.8681e+18,1.8817e+18,1.9458e+18,1.9794e+18,1.9269e+18,1.9727e+18,1.9859e+18,2.0645e+18,2.0415e+18,2.0215e+18,2.0071e+18,1.8585e+18,1.9353e+18,1.9380e+18,2.0216e+18,2.0716e+18,2.0562e+18,2.0734e+18,1.9646e+18,1.9851e+18,2.0450e+18,1.9482e+18,1.9178e+18,1.7991e+18,1.8075e+18,1.8074e+18,1.8444e+18,1.9135e+18,1.9517e+18,1.8846e+18,1.8610e+18,1.8409e+18,1.7636e+18,1.8393e+18,1.8726e+18,1.9260e+18,1.9369e+18,1.9597e+18,1.8751e+18,1.9101e+18,1.9835e+18,1.9642e+18,1.9123e+18,1.9120e+18,1.9396e+18,1.9810e+18,1.9841e+18,1.9455e+18,1.9621e+18,1.9721e+18,1.9773e+18,1.9794e+18,1.9407e+18,1.9546e+18,1.9571e+18,1.9127e+18,1.9151e+18,1.9233e+18,1.9386e+18,1.8707e+18,1.8147e+18,1.8173e+18,1.7759e+18,1.8141e+18,1.8253e+18,1.7812e+18,1.8501e+18,1.8071e+18,1.8022e+18,1.8877e+18,1.7965e+18,1.8152e+18,1.8711e+18,1.7333e+18,1.8606e+18,1.8538e+18,1.7971e+18,1.8522e+18,1.8424e+18,1.8537e+18,1.8769e+18,1.8474e+18,1.8662e+18,1.8717e+18,1.8330e+18,1.8615e+18,1.8511e+18,1.7751e+18,1.4999e+18,1.7680e+18,1.8019e+18,1.8078e+18,1.8637e+18,1.8405e+18,1.7800e+18,1.8216e+18,1.8181e+18,1.8011e+18,1.7840e+18,1.7922e+18,1.7667e+18,1.8006e+18,1.7387e+18,1.6457e+18,1.7245e+18,1.7712e+18,1.6783e+18,1.8085e+18,1.7846e+18,1.7396e+18,1.7856e+18,1.7616e+18,1.7460e+18,1.6432e+18,1.7638e+18,1.8012e+18,1.7462e+18,1.7892e+18,1.7863e+18,1.5469e+18,1.7728e+18,1.7577e+18,1.7095e+18,1.7475e+18,1.6976e+18,1.6175e+18,1.6373e+18,1.6190e+18,1.5464e+18,1.5160e+18,1.4109e+18,1.4731e+18,1.3599e+18,1.4594e+18,1.3518e+18,1.4174e+18,1.1803e+18,1.2628e+18,1.0262e+18,9.0055e+17,6.9174e+17,8.0112e+17,4.2408e+17,2.8841e+17,1.3462e+17,8.8303e+16,2.9984e+16,9.0480e+15,1.1708e+16,47942000000000.0,59296000000000.0,580800000000.000,58196000000000.0,27933000000000.0,2651700000000.00,10441,15944,2509900000.00000,4259800000.00000,73352,41649,2.1249e+15,1.2351e+15,8246900000000.00,5434400000000.00,22158,19230,4.3561e+15,9.0719e+15,5.3672e+15,3.5004e+16,3.2054e+16,1.0636e+17,1.6420e+17,9.8771e+16,2.1614e+17,2.8255e+17,4.8443e+17,6.7466e+17,7.5267e+17,8.3002e+17,8.5766e+17,8.1540e+17,3.8416e+17,1.5141e+17,4.0219e+17,2.7031e+17,4.5741e+17,7.5446e+17,8.6716e+17,9.8742e+17,9.2201e+17,9.3758e+17,7.0100e+17,5.6801e+17,7.1755e+17,6.4322e+17,6.8438e+17,8.0895e+17,9.0900e+17,8.9324e+17,9.3745e+17,9.4651e+17,9.1057e+17,9.8712e+17,9.5230e+17,9.7606e+17,9.3477e+17,9.4814e+17,9.6262e+17,9.6778e+17,9.7783e+17,9.6629e+17,9.1608e+17,9.2039e+17,9.1524e+17,8.3169e+17,8.9573e+17,8.8084e+17,8.9779e+17,8.2002e+17,8.7170e+17,8.7285e+17,7.8857e+17,8.2153e+17,8.8241e+17,8.5049e+17,8.6869e+17,8.4514e+17,8.5063e+17,8.3596e+17,8.2451e+17,8.0058e+17,8.1481e+17,7.6841e+17,7.6146e+17,7.7692e+17,7.4126e+17,7.3321e+17,7.6084e+17,7.2561e+17,7.2881e+17,7.0781e+17,6.8109e+17,6.8660e+17,7.4273e+17,6.7757e+17,6.0768e+17,6.5796e+17,6.6652e+17,6.8138e+17,5.3994e+17,6.0678e+17,4.9138e+17,5.6281e+17,5.9684e+17,5.8825e+17,3.6767e+17,5.2782e+17,5.0982e+17,3.7011e+17,4.4648e+17,4.8943e+17,5.3341e+17,4.0678e+17,4.1023e+17,3.3190e+17,3.2393e+17,4.0381e+17,5.5169e+17,1.8238e+17,5.3124e+17,2.5599e+17,1.6787e+17,3.0715e+17,4.1316e+17,2.9965e+17,2.0799e+17,2.0502e+17,1.0037e+17,7.0182e+16,4.4014e+16,3.6138e+16,8.8905e+16,1.9157e+16,2.8004e+16,6.5684e+15,4.7007e+15,52615,8099400000000.00,2233500000000.00,4822600000000.00,688740000,3622900,13422000000.0000,399760000,206020,19.740,1.3982e-08,0.0049632,2.2375e-15,7.1441e-12,2.9834e-14,5.8784e-09,7.6130e-16,7.8108e-15,1.4739e-18,7.4527e-10,5.1123e-09,3.7106e-26,5176.9,1561.6,11.982,1.9070,1.7553e-08,3.4907e-06,1.4923e-18,0,0,0,0,1.3848e-10,9.6711e-14,0,3.9919e-23,1.5348e-16,5.2698e-07,7.6751e-26,0.010005,8.3468,0.075571,3.2158e-08,0.00018166,2.3047e-09,9.3286e-25,0,3.7272e-08,0.00011684,5.5865e-19,6.7269e-15,5.4490e-08,1709.3,5094.2,23235000,952840,5691300000.00000,4065000000.00000,291700000,2503700000000.00,55573000000000.0,3036400000.00000,2803500000000.00,58112,16594000000000.0,6448500000000.00,36506,2.4177e+15,91208000000000.0,5.6691e+15,3.5845e+15,6.5838e+15,2.7094e+15,3.8829e+16,1.1847e+16,1.6227e+15,3.9875e+16,1.8462e+16,4.2552e+16,1.5954e+16,8.6815e+16,9.5895e+16,2.4085e+16,2.1481e+16,7.7633e+16,3.4751e+16,6.8501e+16,1.1102e+17,5.2678e+15,1.2794e+16,2.0074e+16,1.0463e+17,1.5473e+17,6.4462e+16,1.1851e+17,4.3728e+16,1.0376e+17,8.4314e+16,9.6340e+15,1.1426e+17,9.2669e+16,3.8175e+16,3.0978e+16,6.4519e+16,1.5847e+16,4.4518e+15,9.7066e+16,4.4920e+16,2.7033e+16,9.3221e+16,5.6166e+16,2.7443e+16,3.7030e+16,1.0207e+16,6.8681e+16,1.4405e+16,1.3240e+16,3.5560e+16,1.5423e+17,4.7649e+16,9.0781e+16,1.8064e+17,5.2544e+16,5.1482e+16,1.0584e+17,8.9524e+16,1.4686e+17,2.2333e+17,1.9973e+17,1.4753e+17,1.7003e+17,1.2959e+17,6.8070e+16,4.3309e+16,7.0627e+15,4.9973e+15,2.2032e+15,8.0522e+15,2.6080e+16,3.2267e+15,5.5415e+15,1.1879e+17,6.1106e+16,1.1992e+16,4.2648e+16,1.6284e+17,2.0100e+16,4.0212e+16,2.0060e+16,9.7709e+16,4.7297e+16,1.8402e+17,1.4504e+17,2.0293e+16,2.9560e+16,6.5579e+16,6.5377e+16,26923,1.0026e+15,5.8897e+16,7.8145e+16,1.5226e+17,5.8180e+16,5.9624e+16,1.3538e+17,6.1322e+16,8.8636e+16,1.2181e+17,6.6823e+16,1.4367e+17,8.6974e+16,1.2763e+17,1.6819e+17,1.6316e+17,2.1410e+17,7.6439e+16,1.2154e+17,1.2511e+17,2.2666e+17,1.7252e+17,1.5004e+17,1.9978e+17,1.3914e+17,1.9628e+17,1.9370e+17,1.4452e+17,2.1825e+17,1.7126e+17,2.1423e+17,1.9143e+17,1.9663e+17,2.1218e+17,1.8305e+17,2.1579e+17,2.0997e+17,2.0836e+17,2.1138e+17,2.0339e+17,2.1480e+17,2.0279e+17,1.9773e+17,1.6827e+17,1.6094e+17,1.7031e+17,1.8833e+17,1.6211e+17,1.9346e+17,1.9474e+17,1.4984e+17,1.5557e+17,1.8359e+17,1.6544e+17,1.7083e+17,1.7500e+17,1.8598e+17,1.8799e+17,1.7226e+17,1.7239e+17,2.1165e+17,1.8685e+17,1.8192e+17,1.8846e+17,2.1036e+17,1.9448e+17,1.8601e+17,2.0199e+17,2.0109e+17,1.8917e+17,1.4596e+17,8.9331e+16,1.5434e+17,1.7508e+17,1.8004e+17,1.8847e+17,2.0262e+17,2.0088e+17,1.7489e+17,1.7253e+17,1.9431e+17,2.0061e+17,1.7408e+17,1.6139e+17,1.6661e+17,1.9477e+17,1.7538e+17,1.6997e+17,1.6777e+17,1.6206e+17,1.7317e+17,1.7202e+17,1.8219e+17,1.6791e+17,1.4799e+17,1.6944e+17,1.8860e+17,1.7823e+17,1.5814e+17,1.4897e+17,1.8567e+17,1.8303e+17,1.8495e+17,1.4849e+17,1.7351e+17,1.6995e+17,1.7109e+17,1.6512e+17,1.5534e+17,1.5758e+17,1.4340e+17,1.3191e+17,1.2762e+17,1.3244e+17,1.3476e+17,1.4659e+17,1.5560e+17,1.5583e+17,1.4045e+17,1.3770e+17,1.3708e+17,1.3539e+17,1.3948e+17,1.4568e+17,1.4683e+17,1.4977e+17,1.5167e+17,1.5370e+17,1.5446e+17,1.5580e+17,1.5350e+17,1.5027e+17,1.4801e+17,1.4911e+17,1.4808e+17,1.4500e+17,1.4306e+17]    
    if spectrum == 2:  # 1.5AMD spectrum
        J_wavelength = [3.5748e-08,1.5416e-06,8.6648e-06,0.00038941,0.0040241,0.018873,0.096372,0.20857,7.1253,30.970,129.12,925.93,3383.9,26621,104820,529980,4068400,13166000,50888000,223970000,751170000,1945400000.00000,5708100000.00000,21168000000.0000,59958000000.0000,103680000000.000,232460000000.000,695830000000.000,1399500000000.00,2366900000000.00,4788700000000.00,11931000000000.0,2196.0,34796000000000.0,49619000000000.0,10171,16692,21443,30590,56367,68913,86540,1.3929e+15,2.0036e+15,2.2151e+15,3.3365e+15,5.6944e+15,7.3404e+15,7.8008e+15,9.9139e+15,1.3717e+16,1.5665e+16,1.5635e+16,1.7849e+16,2.3562e+16,3.0136e+16,3.2178e+16,3.5331e+16,3.4685e+16,3.6882e+16,4.3425e+16,5.6082e+16,7.1066e+16,7.2378e+16,7.9943e+16,8.4583e+16,9.1898e+16,9.3112e+16,1.0317e+17,1.1158e+17,1.1685e+17,1.0297e+17,1.0672e+17,1.2925e+17,1.4844e+17,1.5937e+17,1.5339e+17,1.6042e+17,1.7618e+17,1.7199e+17,1.8166e+17,2.1467e+17,2.1676e+17,2.0744e+17,1.9776e+17,1.9433e+17,1.8899e+17,2.1811e+17,2.4224e+17,2.5266e+17,2.5366e+17,2.9390e+17,3.4247e+17,3.6426e+17,3.5942e+17,3.5092e+17,3.2649e+17,3.4190e+17,3.8585e+17,4.2902e+17,4.3512e+17,4.0102e+17,3.8050e+17,3.9442e+17,4.0961e+17,4.1269e+17,4.0674e+17,3.9059e+17,4.0056e+17,4.2829e+17,4.4652e+17,4.3734e+17,4.0279e+17,3.7435e+17,3.6928e+17,3.9815e+17,4.3084e+17,4.5241e+17,4.6241e+17,4.7593e+17,5.0764e+17,5.0865e+17,4.7949e+17,4.7883e+17,5.0137e+17,5.2236e+17,5.3281e+17,5.0573e+17,4.3903e+17,4.2383e+17,4.8376e+17,5.1763e+17,5.0742e+17,5.1888e+17,5.2961e+17,5.1345e+17,5.1340e+17,5.2428e+17,5.0711e+17,5.2290e+17,5.7991e+17,6.2587e+17,6.1143e+17,5.9080e+17,5.7899e+17,5.4929e+17,5.8598e+17,6.4689e+17,6.8651e+17,6.9676e+17,6.9947e+17,6.7787e+17,6.3849e+17,6.0112e+17,5.3065e+17,5.3901e+17,5.0347e+17,4.6919e+17,5.5392e+17,6.6985e+17,7.1114e+17,6.7451e+17,6.2294e+17,6.1232e+17,6.4420e+17,7.0812e+17,7.3104e+17,7.1355e+17,7.4162e+17,7.3726e+17,7.6824e+17,8.4841e+17,9.1218e+17,9.1686e+17,9.0286e+17,8.8878e+17,8.3956e+17,8.3675e+17,8.7760e+17,9.4597e+17,9.6234e+17,8.7285e+17,8.8953e+17,9.2736e+17,8.7091e+17,8.3239e+17,8.0429e+17,7.2731e+17,7.2770e+17,7.2461e+17,7.7564e+17,8.6036e+17,8.9375e+17,8.8205e+17,9.4920e+17,1.0621e+18,1.1477e+18,1.1221e+18,1.0039e+18,9.0278e+17,9.5172e+17,1.0228e+18,1.0439e+18,9.4364e+17,8.0687e+17,7.0015e+17,6.2947e+17,6.1118e+17,7.0923e+17,8.5630e+17,9.4267e+17,9.0335e+17,8.7411e+17,9.1151e+17,9.2234e+17,9.1159e+17,9.0532e+17,9.0152e+17,9.8150e+17,1.0909e+18,1.1477e+18,1.1606e+18,1.2328e+18,1.2538e+18,1.1575e+18,9.6742e+17,7.0237e+17,5.6005e+17,7.2951e+17,1.0091e+18,1.1950e+18,1.2762e+18,1.1252e+18,8.2039e+17,6.3718e+17,9.4352e+17,1.2812e+18,1.5170e+18,1.6151e+18,1.6688e+18,1.6912e+18,1.7702e+18,1.8494e+18,1.7896e+18,1.8273e+18,1.7911e+18,1.7552e+18,1.7322e+18,1.8175e+18,1.9502e+18,1.6700e+18,1.8780e+18,2.0053e+18,1.9325e+18,1.9202e+18,1.9966e+18,2.0655e+18,2.0235e+18,1.9442e+18,2.0324e+18,1.8705e+18,2.1336e+18,2.1138e+18,2.0556e+18,2.0530e+18,2.1248e+18,2.0731e+18,2.0109e+18,2.0388e+18,1.8954e+18,1.5182e+18,1.3838e+18,2.3113e+18,2.1591e+18,2.0024e+18,2.2052e+18,2.4277e+18,2.4872e+18,2.1910e+18,2.1161e+18,2.4350e+18,2.4107e+18,2.5900e+18,2.6367e+18,2.5787e+18,2.6864e+18,2.4172e+18,2.7581e+18,2.8015e+18,2.8048e+18,2.9180e+18,3.0369e+18,2.9175e+18,2.7032e+18,2.9094e+18,2.8987e+18,3.0044e+18,3.0398e+18,2.9849e+18,2.9713e+18,2.9620e+18,3.0761e+18,3.1147e+18,3.1354e+18,3.0494e+18,3.0209e+18,3.0942e+18,2.9659e+18,3.1047e+18,3.1276e+18,3.0165e+18,3.0765e+18,3.2460e+18,3.1298e+18,3.1746e+18,3.2891e+18,3.1868e+18,3.2158e+18,3.3301e+18,3.2760e+18,3.3406e+18,3.3503e+18,3.3725e+18,3.3413e+18,3.2873e+18,3.2856e+18,2.6712e+18,2.9995e+18,3.2555e+18,3.0751e+18,3.4455e+18,3.3208e+18,3.1747e+18,3.4048e+18,3.3329e+18,3.5479e+18,3.3828e+18,3.4497e+18,3.3646e+18,3.3734e+18,3.3706e+18,3.2762e+18,3.2830e+18,3.4430e+18,3.2177e+18,3.4569e+18,3.6051e+18,3.4578e+18,3.3782e+18,3.5489e+18,3.4652e+18,3.5379e+18,3.6407e+18,3.4288e+18,3.3646e+18,3.4702e+18,3.5104e+18,2.8673e+18,3.2870e+18,3.1932e+18,3.4944e+18,3.5282e+18,3.6159e+18,3.4164e+18,3.6830e+18,3.6628e+18,3.5692e+18,3.1292e+18,3.5904e+18,3.7661e+18,3.6281e+18,3.8354e+18,3.7746e+18,3.3781e+18,3.6267e+18,3.6900e+18,3.8564e+18,3.5762e+18,3.7635e+18,3.6788e+18,3.5600e+18,3.4302e+18,3.7418e+18,3.6883e+18,3.8260e+18,3.7469e+18,3.7205e+18,3.7772e+18,3.6776e+18,3.8007e+18,3.7788e+18,3.7832e+18,3.8690e+18,3.7674e+18,3.8492e+18,3.8788e+18,3.8209e+18,3.7352e+18,3.8239e+18,3.6259e+18,3.6981e+18,3.9213e+18,3.7416e+18,3.8916e+18,3.8233e+18,3.8554e+18,3.6537e+18,3.9027e+18,3.8756e+18,3.7890e+18,3.7991e+18,3.6822e+18,3.8971e+18,3.9215e+18,3.9087e+18,3.8281e+18,3.8038e+18,3.9074e+18,3.7943e+18,3.8562e+18,3.9286e+18,3.9538e+18,4.0224e+18,4.0713e+18,4.0703e+18,4.0455e+18,3.9556e+18,4.0507e+18,3.9674e+18,3.4342e+18,3.6580e+18,3.9186e+18,3.8445e+18,3.9065e+18,3.8960e+18,3.8549e+18,3.9784e+18,3.9980e+18,3.9563e+18,3.9638e+18,4.0106e+18,3.9704e+18,3.9179e+18,4.0085e+18,4.0863e+18,4.0866e+18,4.0736e+18,4.1050e+18,4.0989e+18,4.0750e+18,4.0648e+18,4.0509e+18,4.1191e+18,4.0678e+18,3.9512e+18,4.1034e+18,4.0022e+18,3.9583e+18,4.1153e+18,4.1419e+18,4.1508e+18,4.1763e+18,4.0336e+18,4.0122e+18,4.0055e+18,3.9854e+18,3.9880e+18,4.1102e+18,3.8974e+18,4.0398e+18,3.9926e+18,4.0656e+18,3.9219e+18,4.1776e+18,4.1194e+18,4.1764e+18,4.0879e+18,4.2342e+18,4.2691e+18,4.2584e+18,4.1761e+18,4.1852e+18,4.1999e+18,4.2501e+18,4.2385e+18,4.2763e+18,4.1616e+18,4.1508e+18,4.1184e+18,3.9970e+18,4.0244e+18,4.2836e+18,4.1218e+18,4.2570e+18,4.2165e+18,4.0294e+18,3.5425e+18,3.7103e+18,4.1538e+18,4.1754e+18,4.2090e+18,4.1987e+18,4.1717e+18,4.1850e+18,4.2275e+18,4.3088e+18,4.3116e+18,4.2868e+18,4.3077e+18,4.3889e+18,4.3351e+18,4.3335e+18,4.2797e+18,4.3230e+18,4.3234e+18,4.2948e+18,4.3512e+18,4.3177e+18,4.3473e+18,4.3168e+18,4.3303e+18,4.3199e+18,4.3472e+18,4.3068e+18,4.2852e+18,4.2946e+18,4.2042e+18,3.0533e+18,3.5310e+18,3.5587e+18,3.7327e+18,3.8963e+18,4.0117e+18,3.9931e+18,3.9541e+18,4.0368e+18,4.0339e+18,4.2635e+18,4.2029e+18,4.1244e+18,4.1004e+18,4.0544e+18,4.0640e+18,4.0935e+18,4.2046e+18,4.2550e+18,4.2382e+18,4.2265e+18,4.2196e+18,4.2402e+18,4.2726e+18,4.2715e+18,4.2495e+18,4.2063e+18,4.2496e+18,4.1134e+18,4.1624e+18,3.6387e+18,3.3930e+18,3.0503e+18,3.2599e+18,3.5921e+18,4.1002e+18,3.7936e+18,3.5100e+18,3.4578e+18,3.6050e+18,3.6228e+18,3.4804e+18,3.5048e+18,3.7829e+18,3.5954e+18,3.8766e+18,4.0225e+18,4.1610e+18,4.1075e+18,4.0734e+18,4.0730e+18,4.1551e+18,4.0383e+18,4.1421e+18,4.1324e+18,4.1402e+18,4.2326e+18,4.2727e+18,4.2770e+18,4.2741e+18,4.2828e+18,4.2637e+18,4.2554e+18,4.2562e+18,4.2434e+18,4.2645e+18,4.2494e+18,4.3093e+18,4.3028e+18,4.2568e+18,4.2590e+18,4.2913e+18,4.1770e+18,9.4562e+17,5.4890e+17,2.4355e+18,1.3527e+18,1.9186e+18,2.4407e+18,2.8952e+18,3.4586e+18,3.9520e+18,4.0056e+18,4.1267e+18,4.1592e+18,4.1980e+18,4.2015e+18,4.2081e+18,4.2139e+18,4.2295e+18,4.2103e+18,4.2118e+18,4.2365e+18,4.1964e+18,4.1919e+18,4.2178e+18,4.2066e+18,4.1843e+18,4.2082e+18,4.2164e+18,4.1718e+18,4.1252e+18,4.1145e+18,3.9948e+18,4.0533e+18,4.0205e+18,3.9980e+18,4.0375e+18,4.0285e+18,3.9665e+18,4.0351e+18,4.1156e+18,4.0416e+18,3.9813e+18,4.0314e+18,4.0418e+18,3.9732e+18,4.0252e+18,3.9418e+18,4.1070e+18,4.0698e+18,4.0612e+18,3.9648e+18,3.9752e+18,3.9713e+18,3.8785e+18,3.8159e+18,3.4291e+18,3.4023e+18,3.1701e+18,3.2485e+18,3.1419e+18,3.4568e+18,3.2982e+18,3.8144e+18,3.6448e+18,2.5926e+18,3.5931e+18,3.7275e+18,3.5981e+18,3.7959e+18,3.2875e+18,3.5947e+18,3.5486e+18,3.5837e+18,3.4747e+18,3.7163e+18,3.6362e+18,3.9058e+18,3.7933e+18,3.9394e+18,3.9058e+18,3.9188e+18,3.9802e+18,3.9638e+18,3.9170e+18,3.9540e+18,3.8848e+18,4.0082e+18,4.0224e+18,3.9205e+18,3.9278e+18,3.9084e+18,3.5473e+18,3.8751e+18,3.8577e+18,3.8449e+18,3.3963e+18,3.6476e+18,3.8931e+18,3.9716e+18,3.9778e+18,3.9819e+18,3.9728e+18,3.9724e+18,4.0082e+18,4.0375e+18,3.9561e+18,3.8967e+18,3.4389e+18,3.7128e+18,3.8951e+18,3.8607e+18,3.9388e+18,3.8880e+18,3.9458e+18,3.9113e+18,3.8477e+18,3.7972e+18,3.9083e+18,3.9270e+18,3.9164e+18,3.8561e+18,3.8733e+18,3.7504e+18,3.8534e+18,3.8448e+18,3.8654e+18,3.9167e+18,3.7696e+18,3.7865e+18,3.8399e+18,3.8954e+18,3.8566e+18,3.8689e+18,3.8029e+18,3.6598e+18,3.5740e+18,3.4222e+18,3.2145e+18,2.8137e+18,3.0350e+18,2.3290e+18,3.1456e+18,2.5474e+18,2.8380e+18,2.9313e+18,3.5889e+18,3.4778e+18,3.3067e+18,2.7319e+18,2.7925e+18,3.0161e+18,2.6823e+18,2.8700e+18,2.9616e+18,2.7074e+18,2.7027e+18,2.9272e+18,2.4946e+18,3.1552e+18,2.5700e+18,3.1996e+18,3.2261e+18,3.3848e+18,3.0440e+18,3.2385e+18,3.1431e+18,3.1022e+18,3.0708e+18,3.4386e+18,2.5864e+18,2.4222e+18,1.9045e+18,1.8063e+18,1.3318e+18,1.1018e+18,6.3964e+17,1.1151e+18,7.1937e+17,7.2891e+17,8.9539e+17,1.7769e+18,2.1016e+18,1.6613e+18,1.8111e+18,1.2480e+18,1.2825e+18,1.6521e+18,8.7669e+17,1.6690e+18,1.2366e+18,2.2221e+18,6.6686e+17,2.1813e+18,1.2182e+18,1.5564e+18,1.9204e+18,1.5482e+18,1.4917e+18,1.2329e+18,2.0956e+18,1.7039e+18,1.9179e+18,2.1035e+18,2.0177e+18,2.3068e+18,2.0985e+18,2.3060e+18,2.3039e+18,2.3051e+18,2.9872e+18,3.1454e+18,2.9147e+18,3.2779e+18,3.1624e+18,2.7959e+18,2.6561e+18,2.7259e+18,2.6469e+18,2.9551e+18,2.8508e+18,2.9593e+18,2.8091e+18,3.3116e+18,3.2183e+18,3.1134e+18,3.4323e+18,3.2099e+18,3.5020e+18,3.4527e+18,3.4348e+18,3.5046e+18,3.4310e+18,3.5337e+18,3.5255e+18,3.4655e+18,3.5473e+18,3.5400e+18,3.5303e+18,3.4910e+18,3.4908e+18,3.4929e+18,3.4815e+18,3.5281e+18,3.4552e+18,3.4883e+18,3.4397e+18,3.2450e+18,3.3955e+18,3.4706e+18,3.4712e+18,3.4409e+18,3.4419e+18,3.4626e+18,3.4473e+18,3.4451e+18,3.4634e+18,3.4069e+18,3.4256e+18,3.3911e+18,3.4470e+18,3.3282e+18,3.3807e+18,3.3978e+18,3.3431e+18,3.3727e+18,3.3547e+18,3.3915e+18,3.3895e+18,3.3770e+18,3.3844e+18,3.3509e+18,3.3751e+18,3.3632e+18,3.3692e+18,3.3152e+18,3.3385e+18,3.3527e+18,3.3547e+18,3.3235e+18,3.3109e+18,3.3371e+18,3.3175e+18,3.3214e+18,3.3260e+18,3.2959e+18,3.3146e+18,3.2991e+18,3.2162e+18,3.2683e+18,3.3005e+18,3.2850e+18,3.2667e+18,3.2730e+18,3.2563e+18,3.2496e+18,3.2392e+18,3.2526e+18,3.2457e+18,3.2411e+18,3.2109e+18,3.1162e+18,3.2056e+18,3.1350e+18,3.1961e+18,3.1473e+18,3.1989e+18,3.1879e+18,3.1302e+18,3.1496e+18,3.1485e+18,2.9828e+18,3.0799e+18,3.1435e+18,3.1405e+18,3.0836e+18,3.1780e+18,3.0335e+18,3.1493e+18,3.0999e+18,3.0974e+18,3.1075e+18,3.0728e+18,2.9916e+18,3.0379e+18,3.0860e+18,2.9891e+18,3.0676e+18,2.8700e+18,2.9377e+18,3.0759e+18,3.0073e+18,2.8893e+18,3.0604e+18,3.0261e+18,2.6640e+18,2.8153e+18,2.7211e+18,2.6335e+18,3.0266e+18,2.6371e+18,2.6645e+18,2.5535e+18,2.6144e+18,2.4694e+18,2.4593e+18,2.4683e+18,2.6737e+18,2.1068e+18,2.5560e+18,2.2042e+18,2.1912e+18,2.5423e+18,1.7658e+18,2.2017e+18,1.4343e+18,1.6025e+18,1.3378e+18,1.0800e+18,4.2828e+17,1.1686e+18,6.0957e+17,7.6465e+17,1.0018e+18,4.4146e+17,6.9281e+17,5.8830e+17,7.8121e+17,2.7999e+17,8.5283e+17,5.3915e+17,5.7591e+17,3.8436e+17,1.6056e+18,1.2742e+18,8.3621e+17,2.2828e+17,8.4672e+16,7.0455e+17,1.5724e+18,1.1130e+18,1.6332e+18,1.4030e+18,1.0618e+18,1.2349e+18,1.7123e+18,6.2445e+17,8.0558e+17,8.7027e+17,3.2748e+17,1.4967e+18,1.2085e+18,6.7433e+17,1.1272e+18,1.3725e+18,1.3212e+18,7.9257e+17,1.7387e+18,1.5618e+18,1.7497e+18,1.7354e+18,1.8766e+18,1.5983e+18,1.9385e+18,1.9545e+18,2.6138e+18,2.2461e+18,2.1746e+18,2.1003e+18,2.2973e+18,2.3530e+18,2.3744e+18,2.5757e+18,2.5201e+18,2.5588e+18,2.5700e+18,1.9026e+18,2.5519e+18,2.6905e+18,2.6687e+18,2.0394e+18,2.7370e+18,2.4980e+18,2.5816e+18,1.8388e+18,2.4925e+18,2.3891e+18,2.3210e+18,2.7176e+18,2.5990e+18,1.9161e+18,2.3754e+18,2.6433e+18,2.5564e+18,2.7106e+18,2.6047e+18,2.6899e+18,2.5670e+18,2.4798e+18,2.7434e+18,2.4983e+18,2.1047e+18,2.5849e+18,2.5233e+18,2.5259e+18,2.5097e+18,2.0999e+18,2.5304e+18,2.7850e+18,2.4939e+18,2.5163e+18,2.4070e+18,2.6355e+18,2.4580e+18,2.4754e+18,2.7359e+18,2.5328e+18,2.4986e+18,2.7246e+18,2.6624e+18,2.6882e+18,2.6166e+18,2.6854e+18,2.7299e+18,2.6511e+18,2.6104e+18,2.6365e+18,2.7221e+18,2.7586e+18,2.5547e+18,2.7537e+18,2.7599e+18,2.7200e+18,2.7928e+18,2.7615e+18,2.6913e+18,2.7888e+18,2.7610e+18,2.7872e+18,2.7561e+18,2.7854e+18,2.7565e+18,2.7473e+18,2.7569e+18,2.7622e+18,2.7352e+18,2.7241e+18,2.7340e+18,2.7538e+18,2.7442e+18,2.7535e+18,2.7621e+18,2.7489e+18,2.7244e+18,2.7168e+18,2.6999e+18,2.6776e+18,2.7222e+18,2.6617e+18,2.6343e+18,2.6946e+18,2.5902e+18,2.6155e+18,2.4993e+18,2.4057e+18,2.4351e+18,2.2632e+18,2.4117e+18,2.3505e+18,2.3701e+18,2.2645e+18,1.5112e+18,2.3711e+18,2.4993e+18,2.5046e+18,2.4912e+18,2.4925e+18,2.5324e+18,2.5627e+18,2.5837e+18,2.6324e+18,2.6158e+18,2.6024e+18,2.5507e+18,2.3037e+18,2.5175e+18,2.6028e+18,2.6249e+18,2.6464e+18,2.6178e+18,2.6060e+18,2.5433e+18,2.5666e+18,2.5999e+18,2.4680e+18,2.5715e+18,2.5216e+18,2.5295e+18,2.4350e+18,2.3233e+18,2.4527e+18,2.5586e+18,2.2156e+18,2.2745e+18,2.4605e+18,2.1775e+18,1.8938e+18,2.4165e+18,2.4229e+18,1.9319e+18,2.1912e+18,2.4264e+18,1.9064e+18,2.1127e+18,2.1126e+18,1.9888e+18,1.8316e+18,1.8170e+18,2.0612e+18,1.9869e+18,2.1221e+18,1.7133e+18,1.6522e+18,1.9075e+18,1.9315e+18,1.4909e+18,1.6817e+18,2.0640e+18,1.7994e+18,1.7097e+18,1.5079e+18,1.1438e+18,1.4765e+18,9.3477e+17,9.4185e+17,1.3116e+18,1.0948e+18,1.4949e+18,1.1884e+18,1.0669e+18,1.1552e+18,1.1481e+18,1.0939e+18,1.1084e+18,1.1585e+18,8.2881e+17,4.9403e+17,7.1236e+17,3.8073e+17,3.9369e+17,3.1122e+16,1.0606e+17,1.0526e+17,3.0441e+16,9.9785e+15,63288,1.9120e+15,2377.0,31735,47429,27738000000000.0,4860100000000.00,14176000000000.0,31904000000.0000,119910000,20955000000000.0,9029500000000.00,60355000,85125000000000.0,33143000000000.0,985550,3446400000000.00,1949400000000.00,131830000000.000,18388000000000.0,29715,1.2001e+15,2.1672e+15,1.7272e+15,82373,7.4510e+15,35080,54911,15975000000000.0,17305000000000.0,296960000000.000,4165100000000.00,14122000000000.0,17053000000000.0,1.3467e+15,27277000000000.0,3.9394e+15,3.3473e+15,2.3350e+15,16163,78807,51416,4574300000000.00,43106000000.0000,33479,8.6768e+15,5.5521e+15,22210000000.0000,72072000000.0000,1.2575e+16,1.6321e+16,5.0716e+15,2503500000000.00,1.4058e+16,1.2011e+15,1.1357e+16,4.2671e+15,3.2177e+15,1.4593e+16,1.8232e+16,1.6140e+17,2.5169e+15,1.2718e+15,2.4636e+17,8.1541e+16,9.4098e+16,1.4895e+16,5.7500e+16,6.3750e+16,3.2230e+17,6.4240e+16,1.1836e+17,1.8036e+17,1.9405e+17,3.4611e+17,3.1889e+16,2.6606e+17,4.3129e+17,3.5149e+17,1.7679e+16,2.5155e+17,1.4729e+17,1.5060e+17,2.6983e+17,2.1040e+17,9.3478e+16,3.5983e+17,2.7943e+17,2.2458e+17,2.5666e+17,3.1867e+17,4.3720e+17,3.5232e+17,1.6373e+17,2.5688e+17,8.2035e+17,7.2488e+17,1.9489e+17,8.0203e+16,4.4382e+17,5.8372e+17,9.7966e+17,4.7177e+17,6.3151e+17,8.3513e+17,9.7420e+17,1.1649e+18,6.1122e+17,6.4639e+17,9.3529e+17,3.1011e+17,1.0885e+18,6.7047e+17,4.6862e+17,2.5942e+17,5.5372e+17,6.8289e+17,3.5814e+17,1.2881e+17,3.3765e+17,5.0697e+17,7.0318e+17,1.3331e+18,4.9774e+17,5.0498e+17,4.6000e+17,8.6963e+17,4.4005e+17,8.3658e+17,4.2501e+17,1.0791e+18,9.9920e+17,9.0964e+17,8.9828e+17,4.4197e+17,6.8656e+17,1.3824e+18,1.2746e+18,1.4428e+18,1.2007e+18,1.3266e+18,1.4887e+18,1.3355e+18,1.2340e+18,1.6729e+18,1.3904e+18,1.5953e+18,1.8379e+18,1.9481e+18,1.7155e+18,1.3598e+18,1.1801e+18,1.3550e+18,1.8973e+18,1.8798e+18,1.7920e+18,1.3802e+18,1.9968e+18,1.9556e+18,1.9269e+18,1.7933e+18,1.6714e+18,1.9680e+18,1.9036e+18,1.8492e+18,1.8714e+18,1.8153e+18,1.9656e+18,2.0449e+18,1.9628e+18,2.0848e+18,2.0517e+18,1.9300e+18,1.9956e+18,1.9577e+18,2.0863e+18,2.0367e+18,1.9093e+18,2.0193e+18,2.0853e+18,2.0773e+18,2.0172e+18,2.0032e+18,2.0629e+18,2.0549e+18,2.0461e+18,2.0546e+18,1.9953e+18,2.0279e+18,2.0311e+18,2.0537e+18,2.0553e+18,2.0939e+18,2.0784e+18,2.0666e+18,2.0199e+18,2.0717e+18,2.0464e+18,2.0529e+18,2.0638e+18,2.0613e+18,2.0126e+18,2.0357e+18,2.0028e+18,2.0615e+18,2.0465e+18,2.0448e+18,2.0278e+18,2.0622e+18,2.0447e+18,2.0392e+18,2.0097e+18,2.0464e+18,2.0107e+18,2.0168e+18,1.9731e+18,1.9538e+18,1.8571e+18,1.8071e+18,1.8287e+18,1.8015e+18,1.8592e+18,1.8469e+18,1.9025e+18,1.6667e+18,1.8155e+18,1.8286e+18,1.8908e+18,1.9233e+18,1.8722e+18,1.9166e+18,1.9292e+18,2.0055e+18,1.9831e+18,1.9636e+18,1.9496e+18,1.8052e+18,1.8799e+18,1.8824e+18,1.9637e+18,2.0122e+18,1.9973e+18,2.0140e+18,1.9083e+18,1.9283e+18,1.9864e+18,1.8925e+18,1.8633e+18,1.7482e+18,1.7565e+18,1.7564e+18,1.7923e+18,1.8592e+18,1.8961e+18,1.8313e+18,1.8086e+18,1.7891e+18,1.7139e+18,1.7874e+18,1.8195e+18,1.8714e+18,1.8819e+18,1.9041e+18,1.8219e+18,1.8558e+18,1.9272e+18,1.9084e+18,1.8580e+18,1.8577e+18,1.8846e+18,1.9249e+18,1.9279e+18,1.8904e+18,1.9067e+18,1.9164e+18,1.9215e+18,1.9235e+18,1.8860e+18,1.8996e+18,1.9020e+18,1.8590e+18,1.8613e+18,1.8694e+18,1.8843e+18,1.8183e+18,1.7640e+18,1.7665e+18,1.7266e+18,1.7636e+18,1.7745e+18,1.7319e+18,1.7986e+18,1.7569e+18,1.7523e+18,1.8353e+18,1.7469e+18,1.7649e+18,1.8192e+18,1.6856e+18,1.8091e+18,1.8025e+18,1.7478e+18,1.8012e+18,1.7918e+18,1.8029e+18,1.8254e+18,1.7968e+18,1.8151e+18,1.8207e+18,1.7832e+18,1.8108e+18,1.8008e+18,1.7272e+18,1.4602e+18,1.7205e+18,1.7534e+18,1.7593e+18,1.8136e+18,1.7913e+18,1.7324e+18,1.7730e+18,1.7699e+18,1.7533e+18,1.7367e+18,1.7448e+18,1.7203e+18,1.7531e+18,1.6929e+18,1.6024e+18,1.6791e+18,1.7247e+18,1.6347e+18,1.7612e+18,1.7379e+18,1.6943e+18,1.7390e+18,1.7157e+18,1.7008e+18,1.6011e+18,1.7184e+18,1.7546e+18,1.7013e+18,1.7430e+18,1.7403e+18,1.5077e+18,1.7273e+18,1.7126e+18,1.6657e+18,1.7028e+18,1.6544e+18,1.5767e+18,1.5963e+18,1.5786e+18,1.5081e+18,1.4787e+18,1.3763e+18,1.4370e+18,1.3269e+18,1.4238e+18,1.3191e+18,1.3829e+18,1.1521e+18,1.2324e+18,1.0019e+18,8.7943e+17,6.7575e+17,7.8244e+17,4.1444e+17,2.8192e+17,1.3162e+17,8.6345e+16,2.9323e+16,8.8486e+15,1.1450e+16,46888000000000.0,57997000000000.0,568150000000.000,56933000000000.0,27332000000000.0,2595600000000.00,10225,15626,2461500000.00000,4181100000.00000,72044,40926,2.0890e+15,1.2156e+15,8122100000000.00,5351000000000.00,21851,18965,4.2964e+15,8.9470e+15,5.2926e+15,3.4510e+16,3.1600e+16,1.0484e+17,1.6180e+17,9.7295e+16,2.1282e+17,2.7810e+17,4.7657e+17,6.6345e+17,7.3993e+17,8.1566e+17,8.4274e+17,8.0131e+17,3.7747e+17,1.4885e+17,3.9534e+17,2.6585e+17,4.4986e+17,7.4191e+17,8.5290e+17,9.7125e+17,9.0726e+17,9.2278e+17,6.9032e+17,5.5957e+17,7.0681e+17,6.3373e+17,6.7437e+17,7.9707e+17,8.9556e+17,8.8007e+17,9.2355e+17,9.3253e+17,8.9720e+17,9.7248e+17,9.3813e+17,9.6152e+17,9.2082e+17,9.3392e+17,9.4812e+17,9.5311e+17,9.6300e+17,9.5166e+17,9.0233e+17,9.0657e+17,9.0156e+17,8.1932e+17,8.8240e+17,8.6780e+17,8.8450e+17,8.0800e+17,8.5888e+17,8.6005e+17,7.7719e+17,8.0973e+17,8.6972e+17,8.3840e+17,8.5641e+17,8.3335e+17,8.3889e+17,8.2460e+17,8.1348e+17,7.9010e+17,8.0458e+17,7.5905e+17,7.5252e+17,7.6800e+17,7.3293e+17,7.2505e+17,7.5238e+17,7.1766e+17,7.2090e+17,7.0016e+17,6.7379e+17,6.7932e+17,7.3481e+17,6.7043e+17,6.0135e+17,6.5106e+17,6.5956e+17,6.7427e+17,5.3440e+17,6.0051e+17,4.8640e+17,5.5706e+17,5.9075e+17,5.8229e+17,3.6406e+17,5.2253e+17,5.0474e+17,3.6649e+17,4.4213e+17,4.8467e+17,5.2829e+17,4.0299e+17,4.0648e+17,3.2895e+17,3.2111e+17,4.0044e+17,5.4712e+17,1.8099e+17,5.2727e+17,2.5425e+17,1.6679e+17,3.0520e+17,4.1061e+17,2.9793e+17,2.0684e+17,2.0394e+17,9.9872e+16,6.9855e+16,4.3818e+16,3.5981e+16,8.8510e+16,1.9072e+16,2.7878e+16,6.5385e+15,4.6785e+15,52362,8059400000000.00,2222400000000.00,4797700000000.00,685040000,3602800,13347000000.0000,397470000,204610,19.602,1.3881e-08,0.0049267,2.2206e-15,7.0888e-12,2.9610e-14,5.8318e-09,7.5525e-16,7.7481e-15,1.4620e-18,7.3934e-10,5.0715e-09,3.7106e-26,5136,1549.2,11.889,1.8925,1.7423e-08,3.4655e-06,1.4818e-18,0,0,0,0,1.3783e-10,9.6344e-14,0,3.9862e-23,1.5333e-16,5.2687e-07,7.6751e-26,0.010027,8.3735,0.075892,3.2325e-08,0.00018274,2.3199e-09,9.3286e-25,0,3.7584e-08,0.00011787,5.6382e-19,6.7920e-15,5.5036e-08,1726.9,5148.5,23490000,963430,5756700000.00000,4112100000.00000,295120000,2533400000000.00,56238000000000.0,3073100000.00000,2837800000000.00,58826,16798000000000.0,6528700000000.00,36961,2.4481e+15,92354000000000.0,5.7405e+15,3.6299e+15,6.6671e+15,2.7439e+15,3.9323e+16,1.1998e+16,1.6433e+15,4.0382e+16,1.8698e+16,4.3093e+16,1.6158e+16,8.7919e+16,9.7109e+16,2.4389e+16,2.1753e+16,7.8612e+16,3.5189e+16,6.9363e+16,1.1241e+17,5.3340e+15,1.2955e+16,2.0324e+16,1.0593e+17,1.5665e+17,6.5263e+16,1.1998e+17,4.4265e+16,1.0504e+17,8.5348e+16,9.7517e+15,1.1566e+17,9.3794e+16,3.8639e+16,3.1353e+16,6.5299e+16,1.6039e+16,4.5053e+15,9.8220e+16,4.5452e+16,2.7353e+16,9.4316e+16,5.6820e+16,2.7762e+16,3.7457e+16,1.0325e+16,6.9466e+16,1.4568e+16,1.3390e+16,3.5960e+16,1.5596e+17,4.8178e+16,9.1777e+16,1.8261e+17,5.3117e+16,5.2039e+16,1.0697e+17,9.0475e+16,1.4841e+17,2.2566e+17,2.0179e+17,1.4905e+17,1.7177e+17,1.3091e+17,6.8759e+16,4.3744e+16,7.1331e+15,5.0468e+15,2.2248e+15,8.1307e+15,2.6333e+16,3.2577e+15,5.5942e+15,1.1990e+17,6.1680e+16,1.2104e+16,4.3042e+16,1.6434e+17,2.0284e+16,4.0575e+16,2.0235e+16,9.8521e+16,4.7703e+16,1.8560e+17,1.4626e+17,2.0464e+16,2.9810e+16,6.6128e+16,6.5927e+16,27150,1.0111e+15,5.9398e+16,7.8812e+16,1.5357e+17,5.8686e+16,6.0153e+16,1.3660e+17,6.1886e+16,8.9465e+16,1.2297e+17,6.7470e+16,1.4508e+17,8.7840e+16,1.2891e+17,1.6989e+17,1.6483e+17,2.1631e+17,7.7240e+16,1.2282e+17,1.2643e+17,2.2907e+17,1.7435e+17,1.5162e+17,2.0185e+17,1.4058e+17,1.9829e+17,1.9568e+17,1.4599e+17,2.2046e+17,1.7297e+17,2.1636e+17,1.9332e+17,1.9857e+17,2.1425e+17,1.8483e+17,2.1787e+17,2.1200e+17,2.1038e+17,2.1340e+17,2.0523e+17,2.1665e+17,2.0448e+17,1.9933e+17,1.6960e+17,1.6219e+17,1.7160e+17,1.8972e+17,1.6329e+17,1.9484e+17,1.9612e+17,1.5087e+17,1.5662e+17,1.8482e+17,1.6654e+17,1.7195e+17,1.7614e+17,1.8717e+17,1.8919e+17,1.7334e+17,1.7346e+17,2.1296e+17,1.8800e+17,1.8303e+17,1.8961e+17,2.1163e+17,1.9566e+17,1.8711e+17,2.0317e+17,2.0227e+17,1.9028e+17,1.4681e+17,8.9854e+16,1.5522e+17,1.7606e+17,1.8104e+17,1.8951e+17,2.0371e+17,2.0194e+17,1.7580e+17,1.7342e+17,1.9530e+17,2.0160e+17,1.7495e+17,1.6219e+17,1.6742e+17,1.9569e+17,1.7621e+17,1.7076e+17,1.6854e+17,1.6279e+17,1.7394e+17,1.7278e+17,1.8298e+17,1.6863e+17,1.4861e+17,1.7014e+17,1.8936e+17,1.7893e+17,1.5875e+17,1.4954e+17,1.8636e+17,1.8370e+17,1.8561e+17,1.4902e+17,1.7411e+17,1.7052e+17,1.7166e+17,1.6566e+17,1.5584e+17,1.5808e+17,1.4385e+17,1.3232e+17,1.2802e+17,1.3285e+17,1.3518e+17,1.4703e+17,1.5606e+17,1.5628e+17,1.4085e+17,1.3810e+17,1.3747e+17,1.3577e+17,1.3987e+17,1.4608e+17,1.4723e+17,1.5016e+17,1.5207e+17,1.5410e+17,1.5485e+17,1.5619e+17,1.5388e+17,1.5064e+17,1.4836e+17,1.4946e+17,1.4842e+17,1.4533e+17,1.4337e+17]
    # ... at the following wavelength values (nm).
    wavelength = [280,280.500000000000,281,281.500000000000,282,282.500000000000,283,283.500000000000,284,284.500000000000,285,285.500000000000,286,286.500000000000,287,287.500000000000,288,288.500000000000,289,289.500000000000,290,290.500000000000,291,291.500000000000,292,292.500000000000,293,293.500000000000,294,294.500000000000,295,295.500000000000,296,296.500000000000,297,297.500000000000,298,298.500000000000,299,299.500000000000,300,300.500000000000,301,301.500000000000,302,302.500000000000,303,303.500000000000,304,304.500000000000,305,305.500000000000,306,306.500000000000,307,307.500000000000,308,308.500000000000,309,309.500000000000,310,310.500000000000,311,311.500000000000,312,312.500000000000,313,313.500000000000,314,314.500000000000,315,315.500000000000,316,316.500000000000,317,317.500000000000,318,318.500000000000,319,319.500000000000,320,320.500000000000,321,321.500000000000,322,322.500000000000,323,323.500000000000,324,324.500000000000,325,325.500000000000,326,326.500000000000,327,327.500000000000,328,328.500000000000,329,329.500000000000,330,330.500000000000,331,331.500000000000,332,332.500000000000,333,333.500000000000,334,334.500000000000,335,335.500000000000,336,336.500000000000,337,337.500000000000,338,338.500000000000,339,339.500000000000,340,340.500000000000,341,341.500000000000,342,342.500000000000,343,343.500000000000,344,344.500000000000,345,345.500000000000,346,346.500000000000,347,347.500000000000,348,348.500000000000,349,349.500000000000,350,350.500000000000,351,351.500000000000,352,352.500000000000,353,353.500000000000,354,354.500000000000,355,355.500000000000,356,356.500000000000,357,357.500000000000,358,358.500000000000,359,359.500000000000,360,360.500000000000,361,361.500000000000,362,362.500000000000,363,363.500000000000,364,364.500000000000,365,365.500000000000,366,366.500000000000,367,367.500000000000,368,368.500000000000,369,369.500000000000,370,370.500000000000,371,371.500000000000,372,372.500000000000,373,373.500000000000,374,374.500000000000,375,375.500000000000,376,376.500000000000,377,377.500000000000,378,378.500000000000,379,379.500000000000,380,380.500000000000,381,381.500000000000,382,382.500000000000,383,383.500000000000,384,384.500000000000,385,385.500000000000,386,386.500000000000,387,387.500000000000,388,388.500000000000,389,389.500000000000,390,390.500000000000,391,391.500000000000,392,392.500000000000,393,393.500000000000,394,394.500000000000,395,395.500000000000,396,396.500000000000,397,397.500000000000,398,398.500000000000,399,399.500000000000,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014,1015,1016,1017,1018,1019,1020,1021,1022,1023,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1132,1133,1134,1135,1136,1137,1138,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,1151,1152,1153,1154,1155,1156,1157,1158,1159,1160,1161,1162,1163,1164,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,1177,1178,1179,1180,1181,1182,1183,1184,1185,1186,1187,1188,1189,1190,1191,1192,1193,1194,1195,1196,1197,1198,1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1221,1222,1223,1224,1225,1226,1227,1228,1229,1230,1231,1232,1233,1234,1235,1236,1237,1238,1239,1240,1241,1242,1243,1244,1245,1246,1247,1248,1249,1250,1251,1252,1253,1254,1255,1256,1257,1258,1259,1260,1261,1262,1263,1264,1265,1266,1267,1268,1269,1270,1271,1272,1273,1274,1275,1276,1277,1278,1279,1280,1281,1282,1283,1284,1285,1286,1287,1288,1289,1290,1291,1292,1293,1294,1295,1296,1297,1298,1299,1300,1301,1302,1303,1304,1305,1306,1307,1308,1309,1310,1311,1312,1313,1314,1315,1316,1317,1318,1319,1320,1321,1322,1323,1324,1325,1326,1327,1328,1329,1330,1331,1332,1333,1334,1335,1336,1337,1338,1339,1340,1341,1342,1343,1344,1345,1346,1347,1348,1349,1350,1351,1352,1353,1354,1355,1356,1357,1358,1359,1360,1361,1362,1363,1364,1365,1366,1367,1368,1369,1370,1371,1372,1373,1374,1375,1376,1377,1378,1379,1380,1381,1382,1383,1384,1385,1386,1387,1388,1389,1390,1391,1392,1393,1394,1395,1396,1397,1398,1399,1400,1401,1402,1403,1404,1405,1406,1407,1408,1409,1410,1411,1412,1413,1414,1415,1416,1417,1418,1419,1420,1421,1422,1423,1424,1425,1426,1427,1428,1429,1430,1431,1432,1433,1434,1435,1436,1437,1438,1439,1440,1441,1442,1443,1444,1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1455,1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469,1470,1471,1472,1473,1474,1475,1476,1477,1478,1479,1480,1481,1482,1483,1484,1485,1486,1487,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1515,1516,1517,1518,1519,1520,1521,1522,1523,1524,1525,1526,1527,1528,1529,1530,1531,1532,1533,1534,1535,1536,1537,1538,1539,1540,1541,1542,1543,1544,1545,1546,1547,1548,1549,1550,1551,1552,1553,1554,1555,1556,1557,1558,1559,1560,1561,1562,1563,1564,1565,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1625,1626,1627,1628,1629,1630,1631,1632,1633,1634,1635,1636,1637,1638,1639,1640,1641,1642,1643,1644,1645,1646,1647,1648,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1702,1705,1710,1715,1720,1725,1730,1735,1740,1745,1750,1755,1760,1765,1770,1775,1780,1785,1790,1795,1800,1805,1810,1815,1820,1825,1830,1835,1840,1845,1850,1855,1860,1865,1870,1875,1880,1885,1890,1895,1900,1905,1910,1915,1920,1925,1930,1935,1940,1945,1950,1955,1960,1965,1970,1975,1980,1985,1990,1995,2000,2005,2010,2015,2020,2025,2030,2035,2040,2045,2050,2055,2060,2065,2070,2075,2080,2085,2090,2095,2100,2105,2110,2115,2120,2125,2130,2135,2140,2145,2150,2155,2160,2165,2170,2175,2180,2185,2190,2195,2200,2205,2210,2215,2220,2225,2230,2235,2240,2245,2250,2255,2260,2265,2270,2275,2280,2285,2290,2295,2300,2305,2310,2315,2320,2325,2330,2335,2340,2345,2350,2355,2360,2365,2370,2375,2380,2385,2390,2395,2400,2405,2410,2415,2420,2425,2430,2435,2440,2445,2450,2455,2460,2465,2470,2475,2480,2485,2490,2495,2500,2505,2510,2515,2520,2525,2530,2535,2540,2545,2550,2555,2560,2565,2570,2575,2580,2585,2590,2595,2600,2605,2610,2615,2620,2625,2630,2635,2640,2645,2650,2655,2660,2665,2670,2675,2680,2685,2690,2695,2700,2705,2710,2715,2720,2725,2730,2735,2740,2745,2750,2755,2760,2765,2770,2775,2780,2785,2790,2795,2800,2805,2810,2815,2820,2825,2830,2835,2840,2845,2850,2855,2860,2865,2870,2875,2880,2885,2890,2895,2900,2905,2910,2915,2920,2925,2930,2935,2940,2945,2950,2955,2960,2965,2970,2975,2980,2985,2990,2995,3000,3005,3010,3015,3020,3025,3030,3035,3040,3045,3050,3055,3060,3065,3070,3075,3080,3085,3090,3095,3100,3105,3110,3115,3120,3125,3130,3135,3140,3145,3150,3155,3160,3165,3170,3175,3180,3185,3190,3195,3200,3205,3210,3215,3220,3225,3230,3235,3240,3245,3250,3255,3260,3265,3270,3275,3280,3285,3290,3295,3300,3305,3310,3315,3320,3325,3330,3335,3340,3345,3350,3355,3360,3365,3370,3375,3380,3385,3390,3395,3400,3405,3410,3415,3420,3425,3430,3435,3440,3445,3450,3455,3460,3465,3470,3475,3480,3485,3490,3495,3500,3505,3510,3515,3520,3525,3530,3535,3540,3545,3550,3555,3560,3565,3570,3575,3580,3585,3590,3595,3600,3605,3610,3615,3620,3625,3630,3635,3640,3645,3650,3655,3660,3665,3670,3675,3680,3685,3690,3695,3700,3705,3710,3715,3720,3725,3730,3735,3740,3745,3750,3755,3760,3765,3770,3775,3780,3785,3790,3795,3800,3805,3810,3815,3820,3825,3830,3835,3840,3845,3850,3855,3860,3865,3870,3875,3880,3885,3890,3895,3900,3905,3910,3915,3920,3925,3930,3935,3940,3945,3950,3955,3960,3965,3970,3975,3980,3985,3990,3995,4000];

    # Find the locations of the E1 and E2 within the wavelength array
    wavelength1_index = np.searchsorted(wavelength, 1e9*h*c/(E1*q))
    wavelength2_index = np.searchsorted(wavelength, 1e9*h*c/(E2*q))
    
    # Integrate from E1 to E2 to find the particle flux (A/m^2).
    return(trapz(J_wavelength[wavelength2_index:wavelength1_index+1],   # y-values 
                 # +1 because of Python's weird indexing rules.
                 x=wavelength[wavelength2_index:wavelength1_index+1]))  # x-values







def find_Jsc(E1, E2, T_cell, spectrum, concentration):
    """ Purpose: Calculate short-circuit current Jsc (A/m^2) given energy bounds for radiation.
    
    Conc is the given concentration in units of suns.
    Used by find_Voc and max_power_pt. """
    # Current generated by incident sunlight.
    if spectrum == 0: # Blackbody radiation of the sun
        J_Sun = f*concentration*q*particle_flux(E1, E2, T_sun, 0)  
    else: # AM1.5G or D spectra
        J_Sun = concentration*q*spectrum_particle_flux(E1, E2, spectrum)   
    # Current generated from light radiated by nearby surroundings.
    J_Earth = (1-f*concentration)*q*particle_flux(E1, E2, T_cell, 0)
    return(J_Sun + J_Earth)
    
    
    
    
    
    
    

def find_current(volt, E1, E2, T_cell, spectrum, concentration, Jsc=0):
    """ Purpose: Calculate voltage as a function of current.
    
    Used by max_power_pt. """
    
    # Find Jsc if not given
    if Jsc == 0:
        Jsc = find_Jsc(E1, E2, T_cell, spectrum, concentration)                
    if (E1 > volt):
        J_dark = q*particle_flux(E1, infinity, T_cell, volt) 
        return(Jsc - J_dark)  
    else:
        return -1e-2  







# Use find_current slower?        
def find_voltage(J, E1, E2, T_cell, spectrum, concentration, Jsc=0):
    """ Purpose: Calculate voltage as a function of current.
    
    Used by max_power_pt. """
    
    def current_minus_current(volt): 
        # This subfunction can be used for graphing the I-V curve.        
        if (E1 > volt):
            if (volt == 0.0):
                J_dark = 0.0
            else:
                J_dark = q*particle_flux(E1, infinity, T_cell, volt) 
            return(Jsc - J_dark - J)  
            # Finding a zero of 'Jsc - J_dark - J' finds the voltage that 
            # satisfies the definition 'J = Jsc - J_dark'.
        else:
            return -1e-2
    
    return(brentq(current_minus_current, 0, E1)) 






def max_power_pt(E1, E2, T_cell, spectrum, concentration):
    """ Purpose: Calculate maximum power point for a cell between voltages E1 
    and E2.
    
    Output: voltage at maximum power, maximum power
    Used by independent_cell_power. """												

    Jsc = find_Jsc(E1, E2, T_cell, spectrum, concentration)

    def power(volt): 
        # Calculate power as function of voltage.
        # Written as a subfunction as to increase computational speed       
        return -volt*find_current(volt, E1, E2, T_cell, spectrum, concentration, Jsc)
        
    res = minimize_scalar(power, bounds=[0, E1], method='Bounded')
    # If the Voc is found, bounds should be [0, (1-1e-100)*Voc]. 
    return [res.x, -res.fun] 
